# Commit Types 详解

本文档详细说明 Conventional Commits 规范中各种 type 的使用场景和推断规则。

## Type 推断规则

根据变更内容自动推断合适的 commit type：

### feat - 新功能

**使用场景**：
- 新增文件或目录
- 添加新的功能模块
- 实现新的 API 接口
- 添加新的用户界面组件

**识别特征**：
- 新增的文件（git status 显示 `A` 或 `??`）
- 文件名包含 "new"、"add" 等关键词
- 代码中包含新的类、函数定义

**示例**：
```
feat(auth): 添加用户登录功能
feat(api): 实现文件上传接口
feat(ui): 新增数据可视化图表组件
```

### fix - Bug 修复

**使用场景**：
- 修复程序错误
- 解决已知问题
- 修正不符合预期的行为

**识别特征**：
- 提交消息或文件名包含：fix、bug、修复、解决、issue
- 修改了错误处理逻辑
- 调整了边界条件判断

**示例**：
```
fix(api): 修复空指针异常
fix(auth): 解决登录超时问题
fix(ui): 修正按钮点击无响应
```

### docs - 文档

**使用场景**：
- 修改文档文件
- 更新 README
- 添加或修改注释

**识别特征**：
- 文件扩展名：`.md`, `.txt`, `README`
- 仅修改注释内容
- 文档目录下的文件变更

**示例**：
```
docs: 更新 API 使用说明
docs(readme): 添加安装步骤
docs(api): 完善接口文档
```

### style - 代码格式

**使用场景**：
- 代码格式化（不影响功能）
- 调整缩进、空格
- 修改代码风格

**识别特征**：
- 仅有空格、缩进变化
- Linter 自动修复
- 代码格式化工具输出

**示例**：
```
style: 格式化代码
style(eslint): 修复 linter 警告
style: 统一缩进风格
```

### refactor - 重构

**使用场景**：
- 代码重构（不改变功能）
- 优化代码结构
- 重命名变量、函数、类

**识别特征**：
- 文件重命名
- 目录结构调整
- 代码逻辑重组但功能不变

**示例**：
```
refactor(auth): 重构登录逻辑
refactor: 优化数据库查询性能
refactor(utils): 提取公共工具函数
```

### perf - 性能优化

**使用场景**：
- 提升性能
- 优化算法
- 减少资源消耗

**识别特征**：
- 提交消息包含：性能、优化、加速、缓存
- 算法改进
- 数据库查询优化

**示例**：
```
perf(api): 优化查询性能
perf: 添加缓存机制
perf(render): 减少重绘次数
```

### test - 测试

**使用场景**：
- 添加测试用例
- 修改测试代码
- 更新测试配置

**识别特征**：
- 文件名包含：test、spec、__tests__
- 测试目录下的文件
- 测试框架配置文件

**示例**：
```
test(auth): 添加登录测试用例
test: 提升测试覆盖率
test(api): 修复失败的测试
```

### build - 构建系统

**使用场景**：
- 修改构建配置
- 更新依赖版本
- 调整打包流程

**识别特征**：
- 文件：`package.json`, `pom.xml`, `build.gradle`, `Cargo.toml`
- 构建脚本变更
- 依赖管理文件

**示例**：
```
build: 升级依赖版本
build(deps): 更新 React 到 18.0
build: 优化打包配置
```

### ci - CI/CD

**使用场景**：
- 修改 CI 配置
- 更新部署脚本
- 调整自动化流程

**识别特征**：
- 文件：`.github/workflows/`, `.gitlab-ci.yml`, `Jenkinsfile`
- CI/CD 配置目录
- 部署脚本

**示例**：
```
ci: 添加自动化测试流程
ci(github): 更新部署配置
ci: 修复构建失败问题
```

### chore - 其他杂项

**使用场景**：
- 不影响功能的其他修改
- 更新配置文件
- 维护性任务

**识别特征**：
- 配置文件修改（非构建、CI）
- `.gitignore`, `.editorconfig`
- 子模块更新

**示例**：
```
chore: 更新 .gitignore
chore(submodule): 更新子模块版本
chore: 清理无用文件
```

### revert - 回退

**使用场景**：
- 回退之前的提交
- 撤销某个变更

**识别特征**：
- git revert 操作
- 提交消息明确说明回退

**示例**：
```
revert: 回退 feat(auth) 登录功能
revert: 撤销性能优化提交
```

## Type 优先级

当一个提交包含多种类型的变更时，按以下优先级选择：

1. **fix** - Bug 修复优先级最高
2. **feat** - 新功能次之
3. **perf** - 性能优化
4. **refactor** - 重构
5. **test** - 测试
6. **docs** - 文档
7. **build** - 构建
8. **ci** - CI/CD
9. **style** - 格式
10. **chore** - 其他

## 特殊场景

### 多文件类型混合

当提交包含多种文件类型时：
- 优先考虑主要变更的文件类型
- 如果无法判断主次，选择优先级更高的 type
- 可以使用 scope 区分不同模块

### 子模块更新

子模块更新使用特殊格式：
```
chore(submodule): 更新 xxx 子模块
```

### 版本号升级

版本号升级通常配合实际功能变更：
```
feat(release): 发布 v1.2.0 版本
chore(version): 升级版本号到 1.2.0
```
